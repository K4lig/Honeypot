
# Cloud-Based Threat Intelligence System: SSH Honeypot & SIEM Analysis

![Project Banner](https://img.shields.io/badge/Status-Completed-success) ![Tech](https://img.shields.io/badge/Tech-Wazuh%20%7C%20Docker%20%7C%20Cowrie%20%7C%20GCP-blue)

## üö® Problem
In modern cloud environments, public-facing services like SSH are under constant attack by automated botnets and malicious actors. Organizations often lack visibility into **who** is attacking them, **how** they are bypassing authentication, and **what commands** they execute once inside. Without this intelligence, it is difficult to proactively harden defenses against real-world TTPs (Tactics, Techniques, and Procedures).

## üõ†Ô∏è Solution
I designed and deployed a scalable threat detection architecture using **Infrastructure as Code (Docker)** and cloud services. The system decoys attackers into a controlled environment and centralizes telemetry for analysis.

### Architecture
* **Cloud Provider:** Google Cloud Platform (GCP) Compute Engine.
* **Honeypot Node:** Ubuntu Server running **Cowrie** (a medium-interaction SSH/Telnet honeypot) to emulate a vulnerable Linux shell.
* **SIEM Node:** **Wazuh (v4.9)** deployed via **Docker Compose** for log aggregation, correlation, and alerting.
* **Integration:** Custom Wazuh Agent configuration to ingest unstructured JSON logs from Cowrie.
* **Detection:** Developed custom XML decoding rules to map Cowrie events (logins, commands, downloads) to security alerts.

**Technologies Used:** `Wazuh`, `Docker`, `Cowrie`, `Python`, `Bash`, `Google Cloud Platform`, `Linux (Ubuntu)`.

## üìà Outcome
The project resulted in a fully functional Threat Intelligence pipeline capable of:

1.  **Real-Time Detection:** Successfully detected and alerted on brute-force attempts and successful unauthorized logins within milliseconds.
2.  **Attacker Profiling:** Captured attacker shell interaction, including specific commands entered (`whoami`, `curl`, `wget`) and malware download attempts.
3.  **Visualization:** Built a dashboard visualizing the geolocation of attackers, most used credentials, and attack frequency over time.

This project demonstrates practical skills in **Cloud Security**, **Log Analysis**, **Detection Engineering**, and **Containerization**.

---

## üì∏ Screenshots & Demos

### 1. The SIEM Dashboard (Wazuh)
*Overview of security events generated by the Honeypot.*
![Wazuh Dashboard Screenshot]([INSERT_LINK_TO_YOUR_DASHBOARD_IMAGE_HERE])

### 2. Live Attack Detection
*Wazuh alert capturing a "Successful Login" event from an external attacker.*
![Attack Alert Screenshot]([INSERT_LINK_TO_YOUR_ALERT_IMAGE_HERE])

### 3. Captured Commands
*Log details showing the specific commands the attacker tried to execute.*
![Commands Screenshot]([INSERT_LINK_TO_YOUR_COMMANDS_IMAGE_HERE])

---
# üöÄ How to Replicate
## Deployment Guide: Cyber Intelligence Infrastructure (Honeypot + SIEM)

This guide details the step-by-step construction of a threat detection environment in the cloud using Google Cloud Platform (GCP).

**Architecture:**
1.  **SIEM Node:** Wazuh (v4.9) deployed via Docker.
2.  **Honeypot Node:** Cowrie (SSH/Telnet Honeypot) on Ubuntu Server.

---

## üß± PHASE 1: Infrastructure Preparation (GCP)

### 1.1 Configure Firewall (VPC Network)
Before creating the VMs, open the necessary ports.
* **Navigate to:** VPC network > Firewall > Create firewall rule.
* **Name:** `allow-security-lab`
* **Targets:** `All instances in the network`
* **Source IPv4 ranges:** `0.0.0.0/0`
* **Protocols and ports:**
    * `tcp:2222` (For attackers to access the Honeypot).
    * `tcp:443` (To access the Wazuh Dashboard).
    * `tcp:1514-1515` (Internal Agent-Server communication).

### 1.2 Create Virtual Machine 1 (SIEM Server)
* **Name:** `server-siem-wazuh`
* **Zone:** `us-central1-a`
* **Machine type:** `e2-custom` (2 vCPU, **6 GB RAM**). *Critical for Docker performance*.
* **Boot disk:** Ubuntu 22.04 LTS - **Size: 20 GB**.
* **Firewall:** Check "Allow HTTP/HTTPS traffic".

### 1.3 Create Virtual Machine 2 (Honeypot)
* **Name:** `server-honeypot-cowrie`
* **Zone:** `us-central1-a`
* **Machine type:** `e2-micro` (Cost-effective).
* **Boot disk:** Ubuntu 22.04 LTS - Size: 10 GB.
* **Network tags:** Type `honeypot`.

---

## üß† PHASE 2: SIEM Deployment (Wazuh with Docker)

SSH into `server-siem-wazuh`.

### 2.1 Install Docker Engine
```bash
# Update system
sudo apt-get update && sudo apt-get upgrade -y

# Official installation script
curl -fsSL [https://get.docker.com](https://get.docker.com) -o get-docker.sh
sudo sh get-docker.sh

# Grant permissions to the current user
sudo usermod -aG docker $USER
newgrp docker
```

### 2.2 Deploy Wazuh (Single Node)
```bash
# Clone official repository (Version 4.9.0)
git clone [https://github.com/wazuh/wazuh-docker.git](https://github.com/wazuh/wazuh-docker.git) -b v4.9.0
cd wazuh-docker/single-node

# Generate security certificates
docker compose -f generate-indexer-certs.yml run --rm generator

# Start containers
docker compose up -d
```

### 2.3 Dashboard Access
* **URL:** `https://<SIEM_PUBLIC_IP>`
* **User:** `Admin`
* **Password:** `SecretPassword`

## üçØ PHASE 3: Honeypot Deployment (Cowrie)
SSH into `server-honeypot-cowrie.`

### 3.1 Install Dependencies and Create User
```bash
sudo apt-get update
sudo apt-get install -y git python3-venv python3-pip libssl-dev libffi-dev build-essential python3-dev
sudo adduser --disabled-password cowrie
# (Press Enter to accept default values)
```

### 3.2 Install Cowrie (Virtual Environment)
```bash
# Switch to cowrie user
sudo su - cowrie

# Download code
git clone [http://github.com/cowrie/cowrie](http://github.com/cowrie/cowrie)
cd cowrie

# Create virtual environment
python3 -m venv cowrie-env
source cowrie-env/bin/activate

# Install dependencies
pip install --upgrade pip setuptools wheel
pip install --upgrade -r requirements.txt

# Install Cowrie in editable mode (Fixes path errors)
pip install -e .
```

### 3.3 Configure Trap Port (2222)
```bash
cd etc
cp cowrie.cfg.dist cowrie.cfg
nano cowrie.cfg
```
* **Find the line:** `listen_endpoints = tcp:22:interface=0.0.0.0`
* **Change to:** `listen_endpoints = tcp:2222:interface=0.0.0.0`
* Save `(Ctrl+O)` and Exit `(Ctrl+X)`.
cp cowrie.cfg.dist cowrie.cfg
nano cowrie.cfg
``
